<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MusicStore - Tienda Online de Discos</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header class="banner">
        <div class="logo">
            <h1>MusicStore</h1>
        </div>
        <div class="banner-texto">
            <h2>Tu tienda online de discos y vinilos</h2>
        </div>
    </header>

    <nav class="menu">
        <ul>
            <li><a href="#tienda">Nuestra Tienda</a></li>
            <li><a href="#buscar">Buscar</a></li>
            <li><a href="#catalogo">Cat谩logo</a></li>
            <li><a href="#servicios">Servicios</a></li>
            <li><a href="#contacto">Cont谩ctenos</a></li>
            <li><a href="#cotizacion">Cotizaci贸n</a></li>
        </ul>
    </nav>

    <section id="tienda" class="seccion">
        <h2> Nuestra Tienda On-line</h2>
        <p>Bienvenido a <strong>MusicStore</strong>, donde encontrar谩s los mejores discos, colecciones y vinilos de tus artistas favoritos.</p>
        <h3> Administrado por:</h3>
        <ul class="integrantes">
            <li>Andr茅s Ocampo</li>
        </ul>
    </section>

    <section id="catalogo" class="seccion">
        <h2> Cat谩logo de Discos</h2>
        <p>Explora algunos de nuestros discos destacados:</p>
        <div class="catalogo">
            <div class="card">
                <h4>Abbey Road - The Beatles</h4>
                <p><strong>Disponibles:</strong> 12</p>
                <p><strong>PVP:</strong> $69.900</p>
                <button>Ver detalles</button>
            </div>
            <div class="card">
                <h4>Back in Black - AC/DC</h4>
                <p><strong>Disponibles:</strong> 7</p>
                <p><strong>PVP:</strong> $64.900</p>
                <button>Ver detalles</button>
            </div>
            <div class="card">
                <h4>The Dark Side of the Moon - Pink Floyd</h4>
                <p><strong>Disponibles:</strong> 10</p>
                <p><strong>PVP:</strong> $74.900</p>
                <button>Ver detalles</button>
            </div>
            <div class="card">
                <h4>1989 - Taylor Swift</h4>
                <p><strong>Disponibles:</strong> 15</p>
                <p><strong>PVP:</strong> $59.900</p>
                <button>Ver detalles</button>
            </div>
        </div>
    </section>

    <section id="servicios" class="seccion">
        <h2> Nuestros Servicios</h2>
        <div class="servicios">
            <div class="servicio">
                <h3>Venta y Distribuci贸n</h3>
                <p>Encuentra una amplia selecci贸n de discos y colecciones musicales de todos los g茅neros.</p>
            </div>
            <div class="servicio">
                <h3>Asesor铆a Musical</h3>
                <p>Te ayudamos a encontrar los mejores discos seg煤n tus gustos e intereses musicales.</p>
            </div>
        </div>
    </section>

    <section id="contacto" class="seccion">
        <h2> Cont谩ctenos</h2>
        <p><strong>WhatsApp:</strong> +57 300 123 4567</p>
        <p><strong>Celular:</strong> +57 310 765 4321</p>
        <p><strong>Direcci贸n:</strong> Calle 45 #10-20, Medell铆n, Colombia</p>
        <div class="mapa">
            <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3976.7115977564325!2d-75.57610922586917!3d6.241580326282043!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x8e44283a46f6c3a9%3A0x1828bfa7a8c3a82f!2sMedell%C3%ADn!5e0!3m2!1ses!2sco!4v1696423484345!5m2!1ses!2sco"
                width="100%" height="250" style="border:0;" allowfullscreen="" loading="lazy"></iframe>
        </div>
    </section>

    <section id="cotizacion" class="seccion">
        <h2> Solicitud de Cotizaci贸n</h2>
        <form id="formCotizacion" class="formulario" onsubmit="enviarCotizacion(event)">
            
            <label for="nombre">Nombres y Apellidos:</label>
            <input type="text" id="nombre" name="nombre" required>

            <label for="ciudad">Ciudad:</label>
            <select id="ciudad" name="ciudad" required>
                <option value="">Seleccione una ciudad</option>
                <option value="Medell铆n">Medell铆n</option>
                <option value="Bogot谩">Bogot谩</option>
                <option value="Cali">Cali</option>
                <option value="Barranquilla">Barranquilla</option>
            </select>

            <label for="direccion">Direcci贸n:</label>
            <input type="text" id="direccion" name="direccion" required>

            <label for="celular">Celular:</label>
            <input type="tel" id="celular" name="celular" pattern="[0-9]{10}" required placeholder="Ej: 3001234567">

            <h3> Productos de inter茅s</h3>
            <div class="productos">
                <label><input type="checkbox" value="Abbey Road" data-precio="69900"> Abbey Road - The Beatles</label>
                <input type="number" min="1" max="10" placeholder="Cantidad">
                <label><input type="checkbox" value="Back in Black" data-precio="64900"> Back in Black - AC/DC</label>
                <input type="number" min="1" max="10" placeholder="Cantidad">
                <label><input type="checkbox" value="The Dark Side of the Moon" data-precio="74900"> The Dark Side of the Moon - Pink Floyd</label>
                <input type="number" min="1" max="10" placeholder="Cantidad">
                <label><input type="checkbox" value="1989" data-precio="59900"> 1989 - Taylor Swift</label>
                <input type="number" min="1" max="10" placeholder="Cantidad">
            </div>

            <div class="botones">
                <button type="submit">Enviar datos</button>
                <button type="button" onclick="cancelarCotizacion()">Cancelar</button>
            </div>
        </form>

        <div id="tablaCotizacion" class="tabla-resultados"></div>
    </section>

    <footer class="footer">
        <p>&copy; 2025 MusicStore - Todos los derechos reservados.</p>
    </footer>

<script>
function enviarCotizacion(event) {
    event.preventDefault();
    const nombre = document.getElementById('nombre').value;
    const ciudad = document.getElementById('ciudad').value;
    const direccion = document.getElementById('direccion').value;
    const celular = document.getElementById('celular').value;
    const checkboxes = document.querySelectorAll('.productos input[type="checkbox"]:checked');
    let productos = [];

    checkboxes.forEach(chk => {
        const cantidadInput = chk.parentElement.nextElementSibling;
        const cantidad = parseInt(cantidadInput.value) || 0;
        const precio = parseInt(chk.dataset.precio);
        const total = cantidad * precio;
        if (cantidad > 0) productos.push({ nombre: chk.value, cantidad, precio, total });
    });

    if (productos.length === 0) {
        alert("Seleccione al menos un producto con cantidad v谩lida.");
        return;
    }

    // Mostrar cotizaci贸n en pantalla
    let html = `
    <h3> Cotizaci贸n generada</h3>
    <p><strong>Cliente:</strong> ${nombre}</p>
    <p><strong>Ciudad:</strong> ${ciudad}</p>
    <p><strong>Direcci贸n:</strong> ${direccion}</p>
    <p><strong>Celular:</strong> ${celular}</p>
    <table border="1" cellpadding="6">
        <tr><th>Producto</th><th>Cantidad</th><th>Precio Unitario</th><th>Total</th></tr>`;

    let totalGeneral = 0;
    productos.forEach(p => {
        html += `<tr>
            <td>${p.nombre}</td>
            <td>${p.cantidad}</td>
            <td>$${p.precio.toLocaleString()}</td>
            <td>$${p.total.toLocaleString()}</td>
        </tr>`;
        totalGeneral += p.total;
    });

    html += `<tr><td colspan="3" align="right"><strong>Total General</strong></td><td><strong>$${totalGeneral.toLocaleString()}</strong></td></tr></table>`;
    document.getElementById('tablaCotizacion').innerHTML = html;

    // Enviar datos al servidor Flask
    fetch('http://127.0.0.1:5000/guardarCotizacion', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({
            nombre,
            ciudad,
            direccion,
            celular,
            productos
        })
    })
    .then(res => res.json())
    .then(data => {
        alert(data.mensaje);
    })
    .catch(err => {
        console.error("Error al enviar datos:", err);
        alert("Error al guardar en la base de datos.");
    });
}

function cancelarCotizacion() {
    window.location.href = "#tienda";
}
</script>

</body>
</html>
